<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="RSD 5.0.3490" />
    <title>Data Dunkers Visualizations - Data Cleaning</title>
    <style>
      body {
        font-family: sans-serif;
        margin-left: 2%;
        margin-right: 2%;
      }
    </style>
  </head>

  <body>
    <img
      src="https://github.com/Data-Dunkers/lessons/blob/main/images/top-banner.jpg?raw=true"
      alt="Data Dunkers Banner"
      style="width: 50%; height: auto; display: block; margin: 0 auto"
    />
    <h2>Data Cleaning</h2>
    <p class="paragraph">
      Data cleaning is a critical step in any data analysis project. It involves identifying and fixing errors, inconsistencies, and missing values in your dataset. In this activity, we use Python and the pandas library to clean a dataset of Indiana Pacers player statistics.
    </p>

    <h3>What we will do:</h3>
    <ul>
      <li><strong>Flagging Traded Players:</strong> Identify players with a "*" in their name and create a new "Traded" column.</li>
      <li><strong>Cleaning Names:</strong> Remove the "*" characters and strip extra whitespace.</li>
      <li><strong>Extracting Position:</strong> Separate the player's position from the name field.</li>
      <li><strong>Finalizing Names:</strong> Ensure names are clean and consistent.</li>
      <li><strong>Handling Totals and Missing Values:</strong> Fix labels for the "Total" row and fill in missing (NaN) values with zeros.</li>
      <li><strong>Reordering Columns:</strong> Organize the dataset for better readability.</li>
    </ul>

    <div id="visualization-container" style="display: none;">
      <!-- No visualization for this lesson -->
    </div>

    <p class="paragraph">
      This lesson focuses on code-based data manipulation rather than visual interpretation. You will learn how to use string operations to transform columns and prepare your data for analysis.
    </p>

    <footer>
      <h3>Reflection Questions</h3>
      <p class="questions" id="questions"></p>
      <p style="text-align: center">
        <button
          onclick="copyAnswers()"
          style="padding: 10px 20px; margin-top: 10px"
        >
          Copy Answers
        </button>
      </p>
      <p id="gitpullParagraph"></p>
      <p style="text-align: center">
        <a href="index.html">home</a>
      </p>
      <img
        src="https://github.com/Data-Dunkers/lessons/blob/main/images/bottom-banner.jpg?raw=true"
        alt="Data Dunkers Bottom Banner"
        style="width: 50%; height: auto; display: block; margin: 0 auto"
      />
    </footer>

    <script>
      const questions = [
        "Why do you think we set regex=False when checking for the * character?",
        "Explain the difference between .str.split(' ').str[-1] and .str.split(' ').str[:-1].",
        "How would you modify the code to create a FirstName and LastName column instead of keeping the full name together?",
      ];
      const githubUrl =
        "https://github.com/Data-Dunkers/student/blob/main/activities/data-cleaning.ipynb";

      function gitpullLinks(githubUrl) {
        var colabUrl =
          "https://colab.research.google.com/github/" +
          githubUrl.split("github.com/")[1];
        var res = githubUrl.split("/");
        var site = res[2];
        var user = res[3];
        var repo = res[4];
        var treeBlob = res[5];
        var branch = res[6];
        var callystoUrl =
          "https://hub.callysto.ca/jupyter/hub/user-redirect/git-pull?repo=";
        if (site == "github.com") {
          if (treeBlob) {
            var subPath = githubUrl.substring(
              githubUrl.indexOf(branch) + branch.length + 1,
            );
            callystoUrl +=
              encodeURIComponent("https://github.com/" + user + "/") +
              repo +
              "&branch=" +
              branch +
              "&subPath=" +
              subPath +
              "&depth=1";
          } else {
            callystoUrl += githubUrl;
          }
        }
        var parag = `<p>Check out the <a href="${githubUrl}">notebook</a> that generated this activity in <a href="${colabUrl}"> Colab</a> or the <a href="${callystoUrl}">Callysto Hub</a>.</p>`;
        return parag;
      }

      // insert the gitpull links
      try {
        document.getElementById("gitpullParagraph").innerHTML =
          gitpullLinks(githubUrl);
      } catch (error) {
        console.error("Error:", error);
      }

      // add the questions
      questions.forEach((question, index) => {
        const questionHTML = `<label for="question${index + 1}">${index + 1}. ${question}</label><br>
                          <input type="text" style="width:80%; padding:5px; margin:10px 0;" id="question${index + 1}"><br>`;
        document
          .getElementById("questions")
          .insertAdjacentHTML("beforeend", questionHTML);
      });

      const fileName = window.location.pathname.split("/").pop().split(".")[0];

      const savedAnswers = JSON.parse(
        localStorage.getItem(fileName + "Answers"),
      );
      if (savedAnswers) {
        questions.forEach((_, index) => {
          const input = document.getElementById(`question${index + 1}`);
          if (input && savedAnswers[`question${index + 1}`]) {
            input.value = savedAnswers[`question${index + 1}`];
          }
        });
      }

      function saveAnswers() {
        const answers = {};
        questions.forEach((_, index) => {
          answers[`question${index + 1}`] = document.getElementById(
            `question${index + 1}`,
          ).value;
        });
        localStorage.setItem(fileName + "Answers", JSON.stringify(answers));
        console.log("Answers saved.");
      }

      function debounce(fn, delay) {
        let timerId;
        return (...args) => {
          clearTimeout(timerId);
          timerId = setTimeout(() => fn(...args), delay);
        };
      }

      const saveAnswersDebounced = debounce(saveAnswers, 200);
      document
        .getElementById("questions")
        .addEventListener("input", (event) => {
          if (event.target.matches('input[type="text"]')) {
            saveAnswersDebounced();
          }
        });

      function copyAnswers() {
        const answerText = questions
          .map((questionText, index) => {
            const answer = document.getElementById(
              `question${index + 1}`,
            ).value;
            return `${index + 1}. ${questionText}\nAnswer: ${answer}\n`;
          })
          .join("\n");

        navigator.clipboard.writeText(answerText).then(
          () => {
            alert("Answers have been copied to your clipboard");
          },
          () => {
            alert("Failed to copy answers");
          },
        );
      }
    </script>
  </body>
</html>
